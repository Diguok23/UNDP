# Admin Dashboard Authentication - User Flows

## ğŸ  User Journey Maps

### New User Registration Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ START: Visit http://yoursite.com/setup                          â”‚
â”‚ (Admin Portal Homepage)                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Homepage      â”‚
            â”‚ See features   â”‚
            â”‚ and CTA buttonsâ”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                     â”‚
    Click "Create Account" Click "Sign In"
          â”‚                     â”‚
          â–¼                     â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Register Form  â”‚  â”‚  Login Form    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                   â”‚
           â–¼                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Domain Check? â”‚    â”‚Domain Check? â”‚
    â”‚@unedp.org    â”‚    â”‚@unedp.org    â”‚
    â”‚@alghahim..   â”‚    â”‚@alghahim..   â”‚
    â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”˜    â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”˜
       â”‚        â”‚          â”‚        â”‚
      YES      NO        YES      NO
       â”‚        â”‚          â”‚        â”‚
       â–¼        â–¼          â–¼        â–¼
    â”Œâ”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚OKâ”‚    â”‚ERROR:â”‚    â”‚OKâ”‚   â”‚   ERROR: â”‚
    â”‚  â”‚    â”‚"Emailâ”‚    â”‚  â”‚   â”‚ "Email  â”‚
    â”‚  â”‚    â”‚not   â”‚    â”‚  â”‚   â”‚ not     â”‚
    â”‚  â”‚    â”‚rec..." â”‚   â”‚  â”‚   â”‚rec..."  â”‚
    â””â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚         â”‚         â”‚        â”‚
     â–¼         â–¼         â–¼        â–¼
  â”Œâ”€â”€â”€â”€â”   SHOW    CREATE  SHOW
  â”‚Sendâ”‚   ERROR   SESSION ERROR
  â”‚EMAILâ”‚
  â””â”€â”€â”€â”€â”˜
     â”‚
     â–¼
 VERIFY EMAIL
     â”‚
     â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Can now login               â”‚
  â”‚ at /setup/login             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ Login Form     â”‚
          â”‚ With domain    â”‚
          â”‚ validation     â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Credentials  â”‚
            â”‚ validated    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ Redirect to:        â”‚
          â”‚ /setup/dashboard    â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ ADMIN DASHBOARD READY   â”‚
          â”‚ â€¢ Sidebar visible        â”‚
          â”‚ â€¢ User email displayed   â”‚
          â”‚ â€¢ Can access all pages   â”‚
          â”‚ â€¢ Logout button ready    â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Existing User Login Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ START: Visit /setup                      â”‚
â”‚ (Check: Already logged in?)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
        NO (unauthenticated)
              â”‚
              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Homepage /setup  â”‚
    â”‚ Show "Sign In"   â”‚
    â”‚ and "Register"   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
       Click "Sign In"
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Login Page         â”‚
    â”‚ /setup/login       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Enter credentials:  â”‚
    â”‚ â€¢ Email             â”‚
    â”‚ â€¢ Password          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ CLIENT: Check domain â”‚
    â”‚ @unedp.org?          â”‚
    â”‚ @alghahim.co.ke?     â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
         â”‚             â”‚
        YES           NO
         â”‚             â”‚
         â–¼             â–¼
    â”Œâ”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚OK  â”‚        â”‚ SHOW     â”‚
    â”‚    â”‚        â”‚ ERROR    â”‚
    â”‚    â”‚        â”‚ "Email   â”‚
    â”‚    â”‚        â”‚ not      â”‚
    â”‚    â”‚        â”‚ rec..."  â”‚
    â””â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                  â”‚
     â–¼                  â–¼
  SEND TO         User sees
  SUPABASE        generic error
     â”‚            message
     â–¼            No domain
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    info leaked
  â”‚ Verify   â”‚
  â”‚Password  â”‚
  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
       â”‚
     â”Œâ”€â”´â”€â”
     â”‚   â”‚
    OK   ERROR
     â”‚   â”‚
     â–¼   â–¼
  CREATE SHOW
  SESSION ERROR
     â”‚    â”‚
     â–¼    â–¼
  REDIRECT Try Again
  /setup/
  dashboard
     â”‚
     â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ SUCCESS!                    â”‚
  â”‚ â€¢ Logged in                 â”‚
  â”‚ â€¢ Dashboard loaded          â”‚
  â”‚ â€¢ Session active            â”‚
  â”‚ â€¢ Can navigate all pages    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Invalid Domain Attempt Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User tries to login with                 â”‚
â”‚ @gmail.com or other invalid domain       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ User enters:       â”‚
    â”‚ Email: invalid...  â”‚
    â”‚ Password: ****     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ CLIENT-SIDE FILTER   â”‚
    â”‚ Domain validation    â”‚
    â”‚ BEFORE Supabase call â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
         â”‚             â”‚
      @unedp.org      Others
      @alghahim..
         â”‚             â”‚
         â–¼             â–¼
      ALLOWED      BLOCKED
         â”‚             â”‚
         â–¼             â–¼
    Send to       SHOW ERROR
    Supabase      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚"Email notâ”‚
                  â”‚recognizedâ”‚
                  â”‚...use    â”‚
                  â”‚work emailâ”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
                   No Supabase
                   API call made
                   (Saves bandwidth)
                        â”‚
                        â–¼
                   User can retry
                   or return home
```

---

### Session & Logout Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Authenticated user on /setup/dashboard  â”‚
â”‚ (Session is active)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Click Logout button  â”‚
    â”‚ in sidebar footer    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Clear Supabase       â”‚
    â”‚ session              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Redirect to:         â”‚
    â”‚ /setup/login         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Try to access        â”‚
    â”‚ protected route?     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
         â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
         â”‚           â”‚
      YES            NO
         â”‚           â”‚
         â–¼           â–¼
    BLOCKED      PUBLIC
    Redirect   (Homepage,
    to login   Login,
               Register)
         â”‚
         â–¼
    LOGIN PAGE
    (Session cleared)
```

---

## ğŸ” Domain Validation Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Email Submitted (Register or Login)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ CLIENT-SIDE CHECK  â”‚
        â”‚ isAllowedDomain()  â”‚
        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
             â”‚           â”‚
           PASS        FAIL
             â”‚           â”‚
             â–¼           â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Continue
        â”‚ with    â”‚  â”‚ Show Error  â”‚
        â”‚ Supabaseâ”‚  â”‚ "Email not  â”‚
        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜   â”‚ recognized" â”‚
             â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚              â”‚
             â–¼              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    User stays
        â”‚Supabase  â”‚    on form
        â”‚Auth      â”‚    Can retry
        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
             â”‚
        â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
        â”‚          â”‚
     SUCCESS    ERROR
        â”‚          â”‚
        â–¼          â–¼
    CREATE     SHOW ERROR
    SESSION    (Invalid creds)
        â”‚          â”‚
        â–¼          â–¼
    REDIRECT   User retries
    DASHBOARD
```

---

## ğŸ“Š Route Protection Matrix

```
Route                          Public  Auth Required  Sidebar
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
/setup                         âœ…      âŒ            âŒ
/setup/login                   âœ…      âŒ            âŒ
/setup/register                âœ…      âŒ            âŒ
/setup/dashboard               âŒ      âœ…            âœ…
/setup/jobs                    âŒ      âœ…            âœ…
/setup/applications            âŒ      âœ…            âœ…
/setup/countries               âŒ      âœ…            âœ…
/setup/news                    âŒ      âœ…            âœ…
/setup/resources               âŒ      âœ…            âœ…
/setup/settings                âŒ      âœ…            âœ…
```

---

## ğŸ¯ Key Decision Points

```
ENTRY POINT
    â†“
Is user authenticated?
    â”œâ”€ YES â†’ Check current route
    â”‚         â”œâ”€ Public route (/, /login, /register) â†’ Show page
    â”‚         â””â”€ Protected route (/dashboard, etc) â†’ Show dashboard
    â”‚
    â””â”€ NO â†’ Check requested route
            â”œâ”€ Public route â†’ Show page
            â””â”€ Protected route â†’ Redirect to /login


REGISTRATION/LOGIN ATTEMPT
    â†“
Extract domain from email
    â†“
Is domain allowed?
    â”œâ”€ YES (@unedp.org or @alghahim.co.ke)
    â”‚   â†“
    â”‚   Send to Supabase
    â”‚   â”œâ”€ Success â†’ Create session â†’ Redirect to dashboard
    â”‚   â””â”€ Error â†’ Show error message
    â”‚
    â””â”€ NO (any other domain)
        â†“
        Show generic error: "Email not recognized..."
        â†“
        Do NOT contact Supabase
        â†“
        User stays on form
```

---

## ğŸ“± Responsive Behavior

### Desktop (1024px+)
- Full sidebar visible
- Logo + text in header
- Two-column layouts where applicable
- Search bar visible

### Tablet (768px - 1023px)
- Collapsible sidebar or drawer menu
- Logo visible
- Touch-friendly button sizes
- Stacked layouts

### Mobile (< 768px)
- Hamburger menu
- Full-screen navigation drawer
- Touch-optimized forms
- Single column layout
- Larger tap targets
